Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 64
Rules claiming more threads will be scaled down.
Job counts:
	count	jobs
	1	data_postprocess
	1
Select jobs to execute...

[Fri Mar  5 09:28:00 2021]
rule data_postprocess:
    input: inter_results/network_c0_s921.nc, inter_results/network_c1_s921.nc, inter_results/network_c2_s921.nc, inter_results/network_c3_s921.nc, inter_results/network_c4_s921.nc, inter_results/network_c5_s921.nc, inter_results/network_c6_s921.nc, inter_results/network_c7_s921.nc
    output: results/result.xlsx
    jobid: 0
    threads: 64

/home/201403848/anaconda3_new/envs/pypsa-eur/bin/python3.8 /home/201403848/pypsa-mcmc/NOBACKUP/pypsa-eur-mcmc/pypsa-eur-mcmc/.snakemake/scripts/tmpdpsxa__g.data_postprocessing.py
/home/201403848/anaconda3_new/envs/pypsa-eur/lib/python3.8/site-packages/pypsa/io.py:769: FutureWarning: Index.__or__ operating as a set operation is deprecated, in the future this will be a logical operation matching Series.__or__.  Use index.union(other) instead
  pnl[attr] = pnl[attr].reindex(columns=df.index | columns, fill_value=default)
/home/201403848/anaconda3_new/envs/pypsa-eur/lib/python3.8/site-packages/pypsa/io.py:771: FutureWarning: Index.__or__ operating as a set operation is deprecated, in the future this will be a logical operation matching Series.__or__.  Use index.union(other) instead
  pnl[attr] = pnl[attr].reindex(columns=(pnl[attr].columns | columns))
INFO:pypsa.io:Imported network network_c0_s921.nc has buses, carriers, generators, global_constraints, lines, links, loads, storage_units, stores
INFO:numexpr.utils:Note: NumExpr detected 64 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 8.
Traceback (most recent call last):
  File "/home/201403848/anaconda3_new/envs/pypsa-eur/lib/python3.8/site-packages/pandas/core/computation/scope.py", line 201, in resolve
    return self.resolvers[key]
  File "/home/201403848/anaconda3_new/envs/pypsa-eur/lib/python3.8/collections/__init__.py", line 898, in __getitem__
    return self.__missing__(key)            # support subclasses that define __missing__
  File "/home/201403848/anaconda3_new/envs/pypsa-eur/lib/python3.8/collections/__init__.py", line 890, in __missing__
    raise KeyError(key)
KeyError: 'bus4'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/201403848/anaconda3_new/envs/pypsa-eur/lib/python3.8/site-packages/pandas/core/computation/scope.py", line 212, in resolve
    return self.temps[key]
KeyError: 'bus4'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/201403848/pypsa-mcmc/NOBACKUP/pypsa-eur-mcmc/pypsa-eur-mcmc/.snakemake/scripts/tmpdpsxa__g.data_postprocessing.py", line 57, in <module>
    sol = solutions(network, man)
  File "/home/201403848/pypsa-mcmc/NOBACKUP/pypsa-eur-mcmc/pypsa-eur-mcmc/scripts/solutions.py", line 21, in __init__
    co2_emis = self.get_country_emis(network)
  File "/home/201403848/pypsa-mcmc/NOBACKUP/pypsa-eur-mcmc/pypsa-eur-mcmc/scripts/solutions.py", line 229, in get_country_emis
    id_co2_links = network.links.query(query_string('co2 atmosphere')).index
  File "/home/201403848/anaconda3_new/envs/pypsa-eur/lib/python3.8/site-packages/pandas/core/frame.py", line 3466, in query
    res = self.eval(expr, **kwargs)
  File "/home/201403848/anaconda3_new/envs/pypsa-eur/lib/python3.8/site-packages/pandas/core/frame.py", line 3596, in eval
    return _eval(expr, inplace=inplace, **kwargs)
  File "/home/201403848/anaconda3_new/envs/pypsa-eur/lib/python3.8/site-packages/pandas/core/computation/eval.py", line 342, in eval
    parsed_expr = Expr(expr, engine=engine, parser=parser, env=env)
  File "/home/201403848/anaconda3_new/envs/pypsa-eur/lib/python3.8/site-packages/pandas/core/computation/expr.py", line 798, in __init__
    self.terms = self.parse()
  File "/home/201403848/anaconda3_new/envs/pypsa-eur/lib/python3.8/site-packages/pandas/core/computation/expr.py", line 817, in parse
    return self._visitor.visit(self.expr)
  File "/home/201403848/anaconda3_new/envs/pypsa-eur/lib/python3.8/site-packages/pandas/core/computation/expr.py", line 401, in visit
    return visitor(node, **kwargs)
  File "/home/201403848/anaconda3_new/envs/pypsa-eur/lib/python3.8/site-packages/pandas/core/computation/expr.py", line 407, in visit_Module
    return self.visit(expr, **kwargs)
  File "/home/201403848/anaconda3_new/envs/pypsa-eur/lib/python3.8/site-packages/pandas/core/computation/expr.py", line 401, in visit
    return visitor(node, **kwargs)
  File "/home/201403848/anaconda3_new/envs/pypsa-eur/lib/python3.8/site-packages/pandas/core/computation/expr.py", line 410, in visit_Expr
    return self.visit(node.value, **kwargs)
  File "/home/201403848/anaconda3_new/envs/pypsa-eur/lib/python3.8/site-packages/pandas/core/computation/expr.py", line 401, in visit
    return visitor(node, **kwargs)
  File "/home/201403848/anaconda3_new/envs/pypsa-eur/lib/python3.8/site-packages/pandas/core/computation/expr.py", line 737, in visit_BoolOp
    return reduce(visitor, operands)
  File "/home/201403848/anaconda3_new/envs/pypsa-eur/lib/python3.8/site-packages/pandas/core/computation/expr.py", line 731, in visitor
    rhs = self._try_visit_binop(y)
  File "/home/201403848/anaconda3_new/envs/pypsa-eur/lib/python3.8/site-packages/pandas/core/computation/expr.py", line 726, in _try_visit_binop
    return self.visit(bop)
  File "/home/201403848/anaconda3_new/envs/pypsa-eur/lib/python3.8/site-packages/pandas/core/computation/expr.py", line 401, in visit
    return visitor(node, **kwargs)
  File "/home/201403848/anaconda3_new/envs/pypsa-eur/lib/python3.8/site-packages/pandas/core/computation/expr.py", line 710, in visit_Compare
    return self.visit(binop)
  File "/home/201403848/anaconda3_new/envs/pypsa-eur/lib/python3.8/site-packages/pandas/core/computation/expr.py", line 401, in visit
    return visitor(node, **kwargs)
  File "/home/201403848/anaconda3_new/envs/pypsa-eur/lib/python3.8/site-packages/pandas/core/computation/expr.py", line 522, in visit_BinOp
    op, op_class, left, right = self._maybe_transform_eq_ne(node)
  File "/home/201403848/anaconda3_new/envs/pypsa-eur/lib/python3.8/site-packages/pandas/core/computation/expr.py", line 442, in _maybe_transform_eq_ne
    left = self.visit(node.left, side="left")
  File "/home/201403848/anaconda3_new/envs/pypsa-eur/lib/python3.8/site-packages/pandas/core/computation/expr.py", line 401, in visit
    return visitor(node, **kwargs)
  File "/home/201403848/anaconda3_new/envs/pypsa-eur/lib/python3.8/site-packages/pandas/core/computation/expr.py", line 535, in visit_Name
    return self.term_type(node.id, self.env, **kwargs)
  File "/home/201403848/anaconda3_new/envs/pypsa-eur/lib/python3.8/site-packages/pandas/core/computation/ops.py", line 86, in __init__
    self._value = self._resolve_name()
  File "/home/201403848/anaconda3_new/envs/pypsa-eur/lib/python3.8/site-packages/pandas/core/computation/ops.py", line 103, in _resolve_name
    res = self.env.resolve(self.local_name, is_local=self.is_local)
  File "/home/201403848/anaconda3_new/envs/pypsa-eur/lib/python3.8/site-packages/pandas/core/computation/scope.py", line 217, in resolve
    raise UndefinedVariableError(key, is_local) from err
pandas.core.computation.ops.UndefinedVariableError: name 'bus4' is not defined
[Fri Mar  5 09:28:04 2021]
Error in rule data_postprocess:
    jobid: 0
    output: results/result.xlsx

RuleException:
CalledProcessError in line 70 of /home/201403848/pypsa-mcmc/NOBACKUP/pypsa-eur-mcmc/pypsa-eur-mcmc/Snakefile:
Command 'set -euo pipefail;  /home/201403848/anaconda3_new/envs/pypsa-eur/bin/python3.8 /home/201403848/pypsa-mcmc/NOBACKUP/pypsa-eur-mcmc/pypsa-eur-mcmc/.snakemake/scripts/tmpdpsxa__g.data_postprocessing.py' returned non-zero exit status 1.
  File "/home/201403848/anaconda3_new/envs/pypsa-eur/lib/python3.8/site-packages/snakemake/executors/__init__.py", line 2319, in run_wrapper
  File "/home/201403848/pypsa-mcmc/NOBACKUP/pypsa-eur-mcmc/pypsa-eur-mcmc/Snakefile", line 70, in __rule_data_postprocess
  File "/home/201403848/anaconda3_new/envs/pypsa-eur/lib/python3.8/site-packages/snakemake/executors/__init__.py", line 568, in _callback
  File "/home/201403848/anaconda3_new/envs/pypsa-eur/lib/python3.8/concurrent/futures/thread.py", line 57, in run
  File "/home/201403848/anaconda3_new/envs/pypsa-eur/lib/python3.8/site-packages/snakemake/executors/__init__.py", line 554, in cached_or_run
  File "/home/201403848/anaconda3_new/envs/pypsa-eur/lib/python3.8/site-packages/snakemake/executors/__init__.py", line 2350, in run_wrapper
Shutting down, this might take some time.
Exiting because a job execution failed. Look above for error message
